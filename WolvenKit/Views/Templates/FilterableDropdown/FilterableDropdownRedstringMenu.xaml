<templates:FilterableDropdownMenuBase
    x:Class="WolvenKit.Views.Editors.FilterableDropdownRedstringMenu"
    x:TypeArguments="types:IRedString"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:helpers="clr-namespace:WolvenKit.Functionality.Helpers"
    xmlns:editors="clr-namespace:WolvenKit.Views.Editors"
    xmlns:templates="clr-namespace:WolvenKit.Views.Templates"
    xmlns:types="clr-namespace:WolvenKit.RED4.Types;assembly=WolvenKit.RED4"
    xmlns:syncfusion="http://schemas.syncfusion.com/wpf"
    FocusManager.FocusedElement="{Binding ElementName=FilterTextBox}">
    <Grid>
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="*" MinWidth="{StaticResource WolvenKitLabelWidth}" />
            <ColumnDefinition Width="*" MinWidth="{StaticResource WolvenKitLabelWidth}" />
            <ColumnDefinition x:Name="ColumnRefreshButton" Width="{StaticResource WolvenKitButtonGridWidth}" />
        </Grid.ColumnDefinitions>

        <Grid.RowDefinitions>
            <RowDefinition x:Name="FilterRow" MinHeight="{DynamicResource WolvenKitRedEditorRowMinHeight}" />
            <RowDefinition MinHeight="{DynamicResource WolvenKitRedEditorRowMinHeight}" />
        </Grid.RowDefinitions>

        <Border
            Grid.Row="0"
            Grid.ColumnSpan="2"
            BorderBrush="{StaticResource BorderAlt}"
            BorderThickness="0,0,0,1" />

        <Border
            Grid.Row="0"
            Grid.Column="0"
            BorderBrush="{StaticResource BorderAlt}"
            BorderThickness="0,0,1,0" />

        <!-- ====================================== -->
        <!-- Filter -->
        <!-- ====================================== -->
        <syncfusion:SfTextBoxExt
            x:Name="FilterTextBox"
            Grid.Row="0"
            Grid.Column="0"
            Margin="0,0,1,1"
            VerticalContentAlignment="Center"
            FontSize="{DynamicResource WolvenKitFontSubTitle}"
            helpers:TextBoxBehavior.TripleClickSelectAll="True"
            KeyboardNavigation.TabIndex="1"
            Watermark="Filter"
            WatermarkTemplate="{StaticResource PlaceholderTemplate}"
            LostFocus="FilterTextBox_OnFocusLost"
            KeyDown="FilterTextBox_KeyDown"
            Text="{Binding FilterText,
                           RelativeSource={RelativeSource AncestorType={x:Type editors:FilterableDropdownRedstringMenu}},
                           Mode=TwoWay}" />

        <Border
            Grid.Row="0"
            Grid.Column="1"
            BorderBrush="{StaticResource BorderAlt}"
            BorderThickness="0,0,1,0" />

        <!-- ====================================== -->
        <!-- Dropdown -->
        <!-- ====================================== -->
        <ComboBox
            x:Name="Dropdown"
            Grid.Row="0"
            Grid.Column="1"
            Margin="0,0,1,1"
            FontSize="{DynamicResource WolvenKitFontSubTitle}"
            ItemsSource="{Binding FilteredOptions,
                                  RelativeSource={RelativeSource AncestorType={x:Type editors:FilterableDropdownRedstringMenu}},
                                  Mode=OneWay}"
            KeyboardNavigation.TabIndex="2"
            SelectedValuePath="Value"
            DisplayMemberPath="Key"
            SelectedValue="{Binding SelectedOption,
                                    RelativeSource={RelativeSource AncestorType={x:Type editors:FilterableDropdownRedstringMenu}},
                                    Mode=TwoWay}" />

        <!-- ====================================== -->
        <!-- Refresh button -->
        <!-- ====================================== -->
        <Button
            x:Name="RefreshButton"
            Grid.Row="0"
            Grid.Column="2"
            Height="Auto"
            Margin="0"
            Padding="0"
            Click="RefreshButton_OnClick">
            <StackPanel Orientation="Horizontal">
                <templates:IconBox
                    IconPack="Material"
                    Kind="Cached"
                    Margin="{DynamicResource WolvenKitMarginMicro}"
                    Size="{DynamicResource WolvenKitIconSmall}"
                    Foreground="{StaticResource WolvenKitCyan}" />
            </StackPanel>
        </Button>

        <!-- ====================================== -->
        <!-- RedString editor -->
        <!-- ====================================== -->
        <editors:RedStringEditor
            x:Name="RedStringEditor"
            Grid.Row="1"
            Grid.Column="0"
            Grid.ColumnSpan="3"
            RedString="{Binding Data,
                                Mode=TwoWay}">
            <editors:RedStringEditor.Style>
                <Style TargetType="editors:RedStringEditor">
                    <EventSetter
                        Event="ValueChanged"
                        Handler="RedStringEditor_ValueChanged" />
                </Style>
            </editors:RedStringEditor.Style>
        </editors:RedStringEditor>
    </Grid>
</templates:FilterableDropdownMenuBase>
